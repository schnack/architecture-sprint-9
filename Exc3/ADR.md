### <a name="_b7urdng99y53"></a>**Название задачи: Открытие депозитов онлайн** 
### <a name="_hjk0fkfyohdk"></a>**Автор: Столяров Михаил**
### <a name="_uanumrh8zrui"></a>**Дата: 20.02.2025**
### <a name="_3bfxc9a45514"></a>**Функциональные требования**

| **№** | **Действующие лица или системы**               | **Use Case**                          | **Описание**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|:-----:|:-----------------------------------------------|:--------------------------------------|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|  UC1  | Сайт, Интернет-банк, Kafka, АБС                | Обновление ставок депозита            | 1. При изменении ставок АБС публикует событие об изменении ставки<br/>2. Сайт и интернет-банк кэшируют изменения ставок в своих БД.                                                                                                                                                                                                                                                                                                                                                                          |
|  UC2  | Клиент, Сайт                                   | Список доступных ставок               | 1. Клиент переходит на сайт в раздел депозитов<br/>2. Сайт возвращает список актуальных ставок из кэша.                                                                                                                                                                                                                                                                                                                                                                                                      |
|  UC3  | Клиент, Интернет-банк, АБС                     | Список персональных ставок            | 1. Клиент заходит в интернет-банк<br/>2. Интернет-банк запрашивает персональные ставки клиента у АБС<br/>3. Интернет-банк в выводит актуальные ставки из кэша и дополняет персональными ставками полученными из АБС.                                                                                                                                                                                                                                                                                         |
|  UC4  | Клиент, Сайт, Кол-центр, бэк офис, АБС         | Открытие депозита через сайт          | 1. Клиент переходит на страницу сайта `открытия депозита<br/>2. Оставляет Ф.И.О, номер телефона и сумму депозита<br/>3. Сотрудник кол-центра отправляет заявку в АБС.<br/>4. Сотрудник бэк-офиса подтверждает возможность открытия депозита и отправляет решение в кол-центр.<br/>6. Сотрудник кол-центра связывается с клиентом и рассказывает об условиях по депозиту.                                                                                                                                     |
|  UC5  | Клиент, Интернет-банк, смс-шлюз, бэк офис, АБС | Открытие депозита через Интернет банк | 1. Клиент переход на страницу интернет банка открытия депозита.<br/>2. Оформляет заявку на открытие депозита с указанием суммы.<br/>3. Интернет-банк создает заявку в АБС<br/>4. АБС для подтверждения заявки отправляет код смс сообщением. <br/>5. Клиент подтверждает заявку вводом кода из смс сообщения.<br/>6. Интернет-банк отправляет код подтверждение в АБС.<br/>7. Сотрудник бэк-офиса подтверждает заявку в АБС.<br/>8. АБС отправляет СМС сообщение клиенту с информацией об открытии депозита. | 


### <a name="_u8xz25hbrgql"></a>**Нефункциональные требования**

| **№** | **Требование**                                                                           |
|:-----:|:-----------------------------------------------------------------------------------------|
|   R   | Надёжность (Reliability)                                                                 |
|  R1   | Все сервисы должны работать 24/7 и быть доступны в 99.99% случаев.                       |
|  R2   | Сервис должен быть геораспределен.                                                       |
|   P   | Производительность (Performance)                                                         |
|  P1   | Отклик по операциям должен занимать не более 20 миллисекунд.                             |
|  P2   | Сервис должен иметь возможность горизонтального масштабирования.                         |
|  P3   | Клиентские запросы должны отправляться в ближайший ЦОД.                                  |
|  +R   | + Ограничения (Restricitions)                                                            |
|  +R1  | Сервис должен придерживаться системы дизайна для приложений, которая принята в компании. |
|  +R2  | Интернет банк может разрабатываться c использованием микросервисной архитектуры          |
|  +R3  | Для очередей сообщений использовать Kafka.                                               |
|  +R5  | Для реализации новых функций предпочтительно использовать БД MS SQL и Oracle             |
|  +R6  | Интернет-банк должен избежать прямой работы с API АБС и не нагружать базу данных АБС.    |
|  +R7  | Функционал работы СМС должен быть разработан силами внутренних сотрудников банка.        |
|  +R8  | Клиентские подключения должны использовать протокол https                                |
|  +R9  | Подключения интернет банка должны использовать протокол https                            |
| +R10  | Для разработки должны использоваться  ASP.NET, PHP, react.js, PL-SQL                     |

### <a name="_qmphm5d6rvi3"></a>**Решение**

Диаграмма контекста
![Диаграмма контекста](context.drawio.png)

Диаграмма контейнеров
![Диаграмма контейнеров](container.drawio.png)

- Для создания API АБС выбран язык программирования Delphi потому, что клиентская часть написана на delphi и можно будет часть кода перенести в API.
- СМС-шлюз - разрабатывается на php т.к. в ит отделе есть специалисты по php.

### <a name="_bjrr7veeh80c"></a>**Альтернативы**

1. Вертикально масштабировать систему АБС и отказаться от внедрения kafka и от создания микросервиса AБС API. Благодаря этому пути можно быстрее создать MVP, но есть ограничения в масшатибровании.

**Недостатки, ограничения, риски**

1. Внедрение Kafka требует доработки систем подрядчиков: Кол-центр, Интернет-банк.

